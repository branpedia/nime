<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimeStream - Nonton Anime Sub Indo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #0f0f1a;
            color: #f1f1f1;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background-color: #1a1a2e;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6c63ff;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 10px;
        }
        
        .search-container {
            display: flex;
            align-items: center;
            background: #252540;
            border-radius: 30px;
            padding: 5px 15px;
            width: 50%;
        }
        
        .search-container input {
            background: transparent;
            border: none;
            color: #fff;
            padding: 10px;
            width: 100%;
            outline: none;
            font-size: 16px;
        }
        
        .search-container button {
            background: transparent;
            border: none;
            color: #6c63ff;
            cursor: pointer;
            font-size: 18px;
        }
        
        /* Main Content Styles */
        .main-content {
            padding: 30px 0;
        }
        
        .section-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #6c63ff;
            border-left: 4px solid #6c63ff;
            padding-left: 10px;
        }
        
        /* Search Results */
        .search-results {
            margin-bottom: 40px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .anime-card {
            background: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .anime-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .anime-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .anime-info {
            padding: 15px;
        }
        
        .anime-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .anime-detail {
            font-size: 14px;
            color: #a0a0c0;
            margin-bottom: 5px;
        }
        
        /* Anime Detail */
        .anime-detail-page {
            display: none;
        }
        
        .detail-header {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-poster {
            flex: 0 0 250px;
        }
        
        .detail-poster img {
            width: 100%;
            border-radius: 10px;
        }
        
        .detail-info {
            flex: 1;
        }
        
        .detail-title {
            font-size: 28px;
            margin-bottom: 10px;
            color: #fff;
        }
        
        .detail-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .detail-meta span {
            background: #252540;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .detail-synopsis {
            margin-bottom: 20px;
            color: #ccc;
        }
        
        /* Episode List */
        .episode-list {
            margin-top: 30px;
        }
        
        .episode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .episode-card {
            background: #1a1a2e;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: background 0.3s ease;
            cursor: pointer;
        }
        
        .episode-card:hover {
            background: #252540;
        }
        
        /* Video Player */
        .video-player {
            display: none;
            margin-bottom: 30px;
        }
        
        .player-container {
            position: relative;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            background: #000;
        }
        
        .player-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .episode-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .nav-button {
            background: #6c63ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s ease;
        }
        
        .nav-button:hover {
            background: #5752d4;
        }
        
        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }
        
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #6c63ff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Error Message */
        .error-message {
            background: #ff4757;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        
        /* Footer */
        footer {
            background: #1a1a2e;
            padding: 30px 0;
            text-align: center;
            margin-top: 50px;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .footer-logo {
            font-size: 22px;
            font-weight: bold;
            color: #6c63ff;
            margin-bottom: 15px;
        }
        
        .footer-disclaimer {
            max-width: 600px;
            color: #a0a0c0;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-container {
                width: 100%;
            }
            
            .detail-header {
                flex-direction: column;
            }
            
            .detail-poster {
                align-self: center;
            }
            
            .results-grid, .episode-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="showHomePage()">
                    <i class="fas fa-play-circle"></i> AnimeStream
                </a>
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="Cari anime...">
                    <button id="search-button"><i class="fas fa-search"></i></button>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container main-content">
        <!-- Loading Indicator -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>Sedang memuat data...</p>
        </div>
        
        <!-- Error Message -->
        <div id="error-message" class="error-message" style="display: none;">
            Terjadi kesalahan saat memuat data. Silakan coba lagi.
        </div>
        
        <!-- Search Results Section -->
        <div id="search-results" class="search-results">
            <h2 class="section-title">Hasil Pencarian</h2>
            <div class="results-grid" id="results-container">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Anime Detail Section -->
        <div id="anime-detail" class="anime-detail-page">
            <div class="detail-header">
                <div class="detail-poster">
                    <img id="detail-img" src="" alt="Anime Poster">
                </div>
                <div class="detail-info">
                    <h1 id="detail-title" class="detail-title"></h1>
                    <div class="detail-meta" id="detail-meta">
                        <!-- Meta info will be populated by JavaScript -->
                    </div>
                    <div id="detail-synopsis" class="detail-synopsis"></div>
                </div>
            </div>
            
            <div class="episode-list">
                <h2 class="section-title">Daftar Episode</h2>
                <div class="episode-grid" id="episode-container">
                    <!-- Episodes will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Video Player Section -->
        <div id="video-player" class="video-player">
            <h2 class="section-title" id="player-title">Streaming Episode</h2>
            <div class="player-container">
                <iframe id="player-iframe" src="" allowfullscreen></iframe>
            </div>
            <div class="episode-navigation">
                <button class="nav-button" id="prev-episode"><i class="fas fa-arrow-left"></i> Episode Sebelumnya</button>
                <button class="nav-button" id="back-to-detail">Kembali ke Detail Anime</button>
                <button class="nav-button" id="next-episode">Episode Selanjutnya <i class="fas fa-arrow-right"></i></button>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">AnimeStream</div>
                <p class="footer-disclaimer">
                    Disclaimer: Situs ini hanya untuk tujuan edukasi. Semua konten anime adalah hak cipta dari pemiliknya masing-masing.
                </p>
                <p>© 2023 AnimeStream - All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const resultsContainer = document.getElementById('results-container');
        const searchResultsSection = document.getElementById('search-results');
        const animeDetailSection = document.getElementById('anime-detail');
        const videoPlayerSection = document.getElementById('video-player');
        const loadingIndicator = document.getElementById('loading');
        const errorMessage = document.getElementById('error-message');
        
        const detailTitle = document.getElementById('detail-title');
        const detailImg = document.getElementById('detail-img');
        const detailMeta = document.getElementById('detail-meta');
        const detailSynopsis = document.getElementById('detail-synopsis');
        const episodeContainer = document.getElementById('episode-container');
        
        const playerTitle = document.getElementById('player-title');
        const playerIframe = document.getElementById('player-iframe');
        const prevEpisodeBtn = document.getElementById('prev-episode');
        const nextEpisodeBtn = document.getElementById('next-episode');
        const backToDetailBtn = document.getElementById('back-to-detail');
        
        // Current state
        let currentAnime = null;
        let currentEpisode = null;
        let currentEpisodes = [];
        
        // Event Listeners
        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        
        backToDetailBtn.addEventListener('click', () => {
            showAnimeDetail(currentAnime);
        });
        
        // Functions
        function showLoading() {
            loadingIndicator.style.display = 'block';
            errorMessage.style.display = 'none';
            searchResultsSection.style.display = 'none';
            animeDetailSection.style.display = 'none';
            videoPlayerSection.style.display = 'none';
        }
        
        function hideLoading() {
            loadingIndicator.style.display = 'none';
        }
        
        function showError(message) {
            errorMessage.textContent = message || 'Terjadi kesalahan saat memuat data. Silakan coba lagi.';
            errorMessage.style.display = 'block';
        }
        
        async function performSearch() {
            const query = searchInput.value.trim();
            if (query.length === 0) return;
            
            showLoading();
            
            try {
                // In a real implementation, this would call your server API
                const searchResults = await fetchSearchResults(query);
                displaySearchResults(searchResults);
            } catch (error) {
                console.error('Search error:', error);
                showError('Terjadi kesalahan saat mencari anime. Silakan coba lagi.');
            } finally {
                hideLoading();
            }
        }
        
        // Fetch search results from the backend API
        async function fetchSearchResults(query) {
            try {
                // This would be your actual API endpoint in production
                const response = await fetch(`/api/search?query=${encodeURIComponent(query)}`);
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                return await response.json();
            } catch (error) {
                // Fallback to simulated data if API is not available
                console.warn('API not available, using simulated data:', error);
                return simulateSearchAPI(query);
            }
        }
        
        // Simulate API call (replace with actual API call in production)
        async function simulateSearchAPI(query) {
            // This is a simulation - in a real app, you would fetch from your backend API
            
            // Sample data structure based on the HTML you provided for "Bad Girl"
            const sampleData = {
                "bad girl": [
                    {
                        id: 'bad-girl-sub-indo',
                        title: 'Bad Girl',
                        image: 'https://otakudesu.best/wp-content/uploads/2025/07/Bad-Girl.jpg',
                        genres: ['Comedy', 'School'],
                        status: 'Ongoing',
                        rating: '6.91',
                        episodeCount: 0, // Will be updated from detail
                        url: 'https://otakudesu.best/anime/bad-girl-sub-indo/'
                    },
                    {
                        id: 'ungirl-murder-sub-indo',
                        title: 'Undead Girl Murder Farce',
                        image: 'https://otakudesu.best/wp-content/uploads/2023/10/Undead-Girl-Murder-Farce-Sub-Indo.jpg',
                        genres: ['Detective', 'Fantasy', 'Historical', 'Mystery', 'Supernatural', 'Vampire'],
                        status: 'Completed',
                        rating: '7.93',
                        episodeCount: 13,
                        url: 'https://otakudesu.best/anime/ungirl-murder-sub-indo/'
                    },
                    {
                        id: 'school-fleet-subtitle-indonesia',
                        title: 'High School Fleet BD',
                        image: 'https://otakudesu.best/wp-content/uploads/2018/01/High-School-Fleet-Sub-Indo.jpg',
                        genres: ['Action', 'Military', 'School'],
                        status: 'Completed',
                        rating: '7.33',
                        episodeCount: 12,
                        url: 'https://otakudesu.best/anime/school-fleet-subtitle-indonesia/'
                    }
                ],
                "gotoubun no hanayome": [
                    {
                        id: 'gotobun-hanayome-subtitle-indonesia',
                        title: 'Gotoubun no Hanayome',
                        image: 'https://otakudesu.best/wp-content/uploads/2019/01/Gotoubun-no-Hanayome-Sub-Indo.jpg',
                        genres: ['Comedy', 'Harem', 'Romance', 'School', 'Shounen'],
                        status: 'Completed',
                        rating: '7.67',
                        episodeCount: 12,
                        url: 'https://otakudesu.best/anime/gotobun-hanayome-subtitle-indonesia/'
                    },
                    {
                        id: 'gotoubun-hanayome-season-2-sub-indo',
                        title: 'Gotoubun no Hanayome Season 2',
                        image: 'https://otakudesu.best/wp-content/uploads/2021/01/gotoubun-no-hanayome-s2.jpg',
                        genres: ['Comedy', 'Harem', 'Romance', 'School', 'Shounen'],
                        status: 'Completed',
                        rating: '8.16',
                        episodeCount: 12,
                        url: 'https://otakudesu.best/anime/gotoubun-hanayome-season-2-sub-indo/'
                    }
                ]
            };
            
            return new Promise(resolve => {
                setTimeout(() => {
                    // Find the best matching query
                    const normalizedQuery = query.toLowerCase();
                    let results = [];
                    
                    // Check for exact matches first
                    if (sampleData[normalizedQuery]) {
                        results = sampleData[normalizedQuery];
                    } else {
                        // Check for partial matches
                        for (const key in sampleData) {
                            if (normalizedQuery.includes(key) || key.includes(normalizedQuery)) {
                                results = [...results, ...sampleData[key]];
                            }
                        }
                    }
                    
                    // If no results found, return empty array
                    resolve(results.length > 0 ? results : []);
                }, 1000);
            });
        }
        
        async function fetchAnimeDetail(animeId) {
            try {
                // This would be your actual API endpoint in production
                const response = await fetch(`/api/anime/${encodeURIComponent(animeId)}`);
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                return await response.json();
            } catch (error) {
                // Fallback to simulated data if API is not available
                console.warn('API not available, using simulated data:', error);
                return simulateAnimeDetailAPI(animeId);
            }
        }
        
        // Simulate API call for anime details
        async function simulateAnimeDetailAPI(animeId) {
            // Sample data based on anime IDs
            const sampleDetails = {
                'bad-girl-sub-indo': {
                    id: 'bad-girl-sub-indo',
                    title: 'Bad Girl',
                    japanese: 'バッドガール',
                    image: 'https://otakudesu.best/wp-content/uploads/2025/07/Bad-Girl.jpg',
                    score: '6.91',
                    producer: '-',
                    type: 'TV',
                    status: 'Ongoing',
                    totalEpisodes: 0, // Ongoing, unknown total
                    duration: '24 Menit',
                    releaseDate: 'Jul 2025',
                    studio: 'Unknown',
                    genres: ['Comedy', 'School'],
                    synopsis: 'Cerita tentang seorang gadis yang dianggap "bad girl" di sekolahnya, namun sebenarnya memiliki hati yang baik. Dia melalui berbagai petualangan dan tantangan dalam kehidupan sekolahnya.',
                    episodes: [
                        { number: 1, title: 'Episode 1', date: '20 Juli,2025', url: 'https://otakudesu.best/episode/bad-girl-episode-1-sub-indo/' }
                    ]
                },
                'ungirl-murder-sub-indo': {
                    id: 'ungirl-murder-sub-indo',
                    title: 'Undead Girl Murder Farce',
                    japanese: 'アンデッドガール・マーダーファルス',
                    image: 'https://otakudesu.best/wp-content/uploads/2023/10/Undead-Girl-Murder-Farce-Sub-Indo.jpg',
                    score: '7.93',
                    producer: '-',
                    type: 'TV',
                    status: 'Completed',
                    totalEpisodes: 13,
                    duration: '24 Menit',
                    releaseDate: 'Jul 2023',
                    studio: 'Lapin Track',
                    genres: ['Detective', 'Fantasy', 'Historical', 'Mystery', 'Supernatural', 'Vampire'],
                    synopsis: 'Sebuah seri misteri yang mengikuti detektif yang menyelidiki kasus-kasus yang melibatkan makhluk supernatural di era Meiji.',
                    episodes: [
                        { number: 13, title: 'Episode 13 (End)', date: '28 September,2023', url: 'https://otakudesu.best/episode/undead-girl-murder-farce-episode-13-sub-indo/' },
                        { number: 12, title: 'Episode 12', date: '21 September,2023', url: 'https://otakudesu.best/episode/undead-girl-murder-farce-episode-12-sub-indo/' },
                        { number: 11, title: 'Episode 11', date: '14 September,2023', url: 'https://otakudesu.best/episode/undead-girl-murder-farce-episode-11-sub-indo/' },
                        // Add more episodes as needed
                    ]
                },
                'gotobun-hanayome-subtitle-indonesia': {
                    id: 'gotobun-hanayome-subtitle-indonesia',
                    title: 'Gotoubun no Hanayome',
                    japanese: '五等分の花嫁',
                    image: 'https://otakudesu.best/wp-content/uploads/2019/01/Gotoubun-no-Hanayome-Sub-Indo.jpg',
                    score: '7.67',
                    producer: '-',
                    type: 'TV',
                    status: 'Completed',
                    totalEpisodes: 12,
                    duration: '24 Menit',
                    releaseDate: 'Jan 11, 2019',
                    studio: 'Tezuka Productions',
                    genres: ['Comedy', 'Harem', 'Romance', 'School', 'Shounen'],
                    synopsis: 'Fuutarou Uesugi merupakan siswa cerdas namun memiliki hidup yang sulit. Fuutarou selalu menyendiri dan fokus terhadap belajar, tidak memiliki ibu serta teman, keluarganya dililit banyak hutang, bahkan ia dan adiknya seringkali merasa kelaparan. Oleh karena itu, kesempatan yang muncul di depannya tak akan ia lepaskan. Ia dimintai oleh seseorang untuk menjadi guru les dengan bayaran yang tinggi. Dan ternyata murid yang harus Fuutarou ajari satu sekolah dengan dirinya. Dan terlebih lagi, ia harus mengajar untuk kakak beradik kembar 5 yang memiliki sifat berbeda-beda, mereka tidak suka belajar dan memiliki nilai yang sangat rendah serta berkesempatan besar untuk tidak naik kelas. Sebagian dari mereka ada yang menolak untuk diajari bahkan mengusir Fuutarou. Hal tersebut membuat pekerjaan paruh waktunya menjadi rumit & sulit. Namun Fuutarou tak pantang menyerah, ia bersikeras untuk menjadi pengajar mereka karena dirinya sangat membutuhkan bayaran tersebut. Apa yang harus dia lakukan agar kelima gadis cantik tersebut dapat lulus? rencana apakah yang akan dilakukan oleh Fuutarou?',
                    episodes: [
                        { number: 12, title: 'Episode 12 (End)', date: '28 Maret,2019', url: 'https://otakudesu.best/episode/gth-episode-12-sub-indo/' },
                        { number: 11, title: 'Episode 11', date: '21 Maret,2019', url: 'https://otakudesu.best/episode/gth-episode-11-sub-indo/' },
                        { number: 10, title: 'Episode 10', date: '14 Maret,2019', url: 'https://otakudesu.best/episode/gth-episode-10-sub-indo/' },
                        // Add more episodes as needed
                    ]
                }
            };
            
            return new Promise(resolve => {
                setTimeout(() => {
                    // Return the anime detail or empty object if not found
                    resolve(sampleDetails[animeId] || {});
                }, 1000);
            });
        }
        
        async function fetchStreamingUrl(episodeUrl) {
            try {
                // This would be your actual API endpoint in production
                const response = await fetch(`/api/stream?url=${encodeURIComponent(episodeUrl)}`);
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                const data = await response.json();
                return data.streamingUrl;
            } catch (error) {
                // Fallback to simulated data if API is not available
                console.warn('API not available, using simulated data:', error);
                return simulateStreamingAPI(episodeUrl);
            }
        }
        
        // Simulate API call for streaming URL
        async function simulateStreamingAPI(episodeUrl) {
            return new Promise(resolve => {
                setTimeout(() => {
                    // Return a mock streaming URL
                    resolve('https://www.youtube.com/embed/dQw4w9WgXcQ'); // Placeholder
                }, 500);
            });
        }
        
        function displaySearchResults(results) {
            resultsContainer.innerHTML = '';
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<p>Tidak ada hasil ditemukan. Coba dengan kata kunci lain.</p>';
                return;
            }
            
            results.forEach(anime => {
                const card = document.createElement('div');
                card.className = 'anime-card';
                card.innerHTML = `
                    <img src="${anime.image}" alt="${anime.title}" onerror="this.src='https://via.placeholder.com/225x320/1a1a2e/6c63ff?text=No+Image'">
                    <div class="anime-info">
                        <div class="anime-title">${anime.title}</div>
                        <div class="anime-detail">Status: ${anime.status}</div>
                        <div class="anime-detail">Rating: ${anime.rating}</div>
                        <div class="anime-detail">Genre: ${anime.genres.join(', ')}</div>
                    </div>
                `;
                
                card.addEventListener('click', async () => {
                    showLoading();
                    try {
                        const animeDetail = await fetchAnimeDetail(anime.id);
                        if (animeDetail && animeDetail.title) {
                            showAnimeDetail(animeDetail);
                        } else {
                            throw new Error('Anime detail not found');
                        }
                    } catch (error) {
                        console.error('Error fetching anime detail:', error);
                        showError('Gagal memuat detail anime. Silakan coba lagi.');
                    } finally {
                        hideLoading();
                    }
                });
                
                resultsContainer.appendChild(card);
            });
            
            searchResultsSection.style.display = 'block';
            animeDetailSection.style.display = 'none';
            videoPlayerSection.style.display = 'none';
            errorMessage.style.display = 'none';
        }
        
        function showAnimeDetail(anime) {
            currentAnime = anime;
            currentEpisodes = anime.episodes || [];
            
            detailTitle.textContent = anime.title;
            detailImg.src = anime.image;
            detailImg.onerror = function() {
                this.src = 'https://via.placeholder.com/250x350/1a1a2e/6c63ff?text=No+Image';
            };
            
            // Create meta info
            detailMeta.innerHTML = `
                ${anime.score ? `<span>Skor: ${anime.score}</span>` : ''}
                ${anime.type ? `<span>Tipe: ${anime.type}</span>` : ''}
                ${anime.status ? `<span>Status: ${anime.status}</span>` : ''}
                ${anime.totalEpisodes ? `<span>Episode: ${anime.totalEpisodes}</span>` : ''}
                ${anime.duration ? `<span>Durasi: ${anime.duration}</span>` : ''}
                ${anime.releaseDate ? `<span>Rilis: ${anime.releaseDate}</span>` : ''}
                ${anime.studio ? `<span>Studio: ${anime.studio}</span>` : ''}
            `;
            
            detailSynopsis.textContent = anime.synopsis || 'Tidak ada sinopsis tersedia.';
            
            // Create episode list
            episodeContainer.innerHTML = '';
            
            if (currentEpisodes.length === 0) {
                episodeContainer.innerHTML = '<p>Tidak ada episode tersedia.</p>';
            } else {
                currentEpisodes.forEach(episode => {
                    const episodeCard = document.createElement('div');
                    episodeCard.className = 'episode-card';
                    episodeCard.innerHTML = `Episode ${episode.number}`;
                    
                    episodeCard.addEventListener('click', async () => {
                        showLoading();
                        try {
                            const streamingUrl = await fetchStreamingUrl(episode.url);
                            playEpisode(episode, streamingUrl);
                        } catch (error) {
                            console.error('Error fetching streaming URL:', error);
                            showError('Gagal memuat video. Silakan coba lagi.');
                        } finally {
                            hideLoading();
                        }
                    });
                    
                    episodeContainer.appendChild(episodeCard);
                });
            }
            
            searchResultsSection.style.display = 'none';
            animeDetailSection.style.display = 'block';
            videoPlayerSection.style.display = 'none';
            errorMessage.style.display = 'none';
        }
        
        function playEpisode(episode, streamingUrl) {
            currentEpisode = episode;
            
            playerTitle.textContent = `${currentAnime.title} - Episode ${episode.number}`;
            playerIframe.src = streamingUrl;
            
            // Set up navigation buttons
            const currentIndex = currentEpisodes.findIndex(ep => ep.number === episode.number);
            
            if (currentIndex > 0) {
                prevEpisodeBtn.style.display = 'block';
                prevEpisodeBtn.onclick = async () => {
                    const prevEpisode = currentEpisodes[currentIndex - 1];
                    showLoading();
                    try {
                        const streamingUrl = await fetchStreamingUrl(prevEpisode.url);
                        playEpisode(prevEpisode, streamingUrl);
                    } catch (error) {
                        console.error('Error fetching streaming URL:', error);
                        showError('Gagal memuat video. Silakan coba lagi.');
                    } finally {
                        hideLoading();
                    }
                };
            } else {
                prevEpisodeBtn.style.display = 'none';
            }
            
            if (currentIndex < currentEpisodes.length - 1) {
                nextEpisodeBtn.style.display = 'block';
                nextEpisodeBtn.onclick = async () => {
                    const nextEpisode = currentEpisodes[currentIndex + 1];
                    showLoading();
                    try {
                        const streamingUrl = await fetchStreamingUrl(nextEpisode.url);
                        playEpisode(nextEpisode, streamingUrl);
                    } catch (error) {
                        console.error('Error fetching streaming URL:', error);
                        showError('Gagal memuat video. Silakan coba lagi.');
                    } finally {
                        hideLoading();
                    }
                };
            } else {
                nextEpisodeBtn.style.display = 'none';
            }
            
            searchResultsSection.style.display = 'none';
            animeDetailSection.style.display = 'none';
            videoPlayerSection.style.display = 'block';
            errorMessage.style.display = 'none';
        }
        
        function showHomePage() {
            searchInput.value = '';
            searchResultsSection.style.display = 'block';
            animeDetailSection.style.display = 'none';
            videoPlayerSection.style.display = 'none';
            errorMessage.style.display = 'none';
            
            resultsContainer.innerHTML = '<p>Gunakan kolom pencarian untuk mencari anime.</p>';
        }
        
        // Initialize with empty search results
        showHomePage();
    </script>
</body>
</html>
